# Police Dispatch Lua
 Голосовой диспетчер полиции для GTA SAMP

![Главное меню скрипта на диалоге](https://i.imgur.com/jekkWsT.png)

## Что делает скрипт?
Данный Lua скрипт добавляет сообщения диспетчера или офицеров прямо в игре. 
Отличительная особенность данного скрипта от других - это гибкая настройка в задокументированном конфиг-файле и возможность добавления собственных событий и звуков, помимо прописанных в скрипте.
При желании можно полностью отклонится от первоначальных шаблонов и сделать совершенно другого диспетчера, другие звуки и так далее.
Диспетчер может озвучивать районы, классы транспорта, их цвет, тен-коды.

## Как работает скрипт?
Скрипт реагирует на сообщения в чате, указанные в файле `config.json` и берет из них информацию для озвучки. Сам конфиг файл детально задокументирован.
Скрипт имеет уже готовые шаблоны для озвучки вызовов 911, /find и сообщений в /r на код 1 и код 0, но есть возможность создать собственные шаблоны.
### Пример собственных шаблонов
Примеры взяты из сообщений на Revent-RP.

```javascript
"user": [
    {
        // Имя, отображаемое в меню.
        "name": "/sos",

        // Переменная @nick затычка (Аналог .+ в регулярных выражениях)
        "pattern": " [Дежурный]: @nick нуждается в поддержке, он отмечен красным маркером на карте",
        "useRegexInPattern": false,

        "markerId": 1, // Брать инфу о районе из красного маркера.
        "sounds": [
            // Звуки берутся из config.lua -> DISPATCH_SOUNDS
            "DISP.words.headTo10",
            "DISP.codesWithIn.91",
            // Озвучка района, в котором находится маркер.
            "@area"
        ],
        // Воспроизводить звук рации.
        "isPlayRadioOn": true
    }
]
```
Простой пример, который, когда появится строчка в чате по формату:
" [Дежурный]: Nick_Name нуждается в поддержке, он отмечен красным маркером на карте",
скажет: `we Head To 10-91 in a районВКоторомКрасныйМаркер`.

Второй пример, показывает возможности пользовательских переменных:
```javascript
"user": [
    {
        "name": "Закусочные",
        // Паттерн не обязательно дописывать до конца строки.
        "pattern": " [Диспетчер]: Поступил вызов от Закусочной №@area! В ней совершается",
        "useRegexInPattern": false,

        "sounds": [
            "DISP.words.weGot10",
            "DISP.codesWithIn.24",
            "@area"
        ],
        "vars": {
            "area": {
                "1": "Redsands East",
                "3": "Mulholland",
                "4": "Old Venturas",
                "5": "Verona",
                "6": "Financial",
                "7": "Calton Heights",
                "8": "Garcia",
                "9": "City Hall",
                "11": "East Los-Santos",
                "12": "Willowfield",
                "13": "Downtown",
                "14": "Financial",
                "15": "Tierra Robada",
                "16": "The Emerald Isle",
                "17": "Old Venturas",
                "18": "Idlewood",
                "19": "Montgomery",
                "20": "Starfish Casino",
                "21": "Fort Carson",
                "22": "Blueberry"
            }
        },
        "isPlayRadioOn": true
    }
]
```
Из строки формата " [Диспетчер]: Поступил вызов от Закусочной №n! В ней совершается", мы можем получить только номер закусочной. Но при помощи конструкции `"vars"`, мы можем обозначить конкретный район.

Больше примеров и пояснений можно найти в самом конфиг файле.

## Демонстрация работы скрипта на видео
https://www.youtube.com/embed/fyLzhiWMPBo

Страница скрипта на _BlastHack_: https://blast.hk/threads/59503/